<html><head><link rel="import" href="../bower_components/polymer/polymer.html"><link rel="import" href="../bower_components/iron-ajax/iron-ajax.html"><link rel="import" href="../bower_components/paper-item/paper-item.html"><link rel="import" href="../bower_components/iron-list/iron-list.html"><link rel="import" href="../bower_components/iron-label/iron-label.html"><link rel="import" href="../bower_components/paper-card/paper-card.html"><link rel="import" href="../bower_components/paper-button/paper-button.html"><link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html"><link rel="import" href="../bower_components/paper-styles/color.html"><link rel="import" href="../bower_components/paper-styles/typography.html"><link rel="import" href="shared-styles.html"></head><body><dom-module id="my-view1"><template><style>:host{display:block;line-height:8px;padding:10px;}body{display:flex;align-items:center;justify-content:center;}paper-card{max-width:500px;margin-bottom:-190px;display:block;background:white;padding:10px;border-radius:20px;line-height:8px;}.cafe-header{@apply (--paper-font-headline);}.cafe-light{color:var(--paper-grey-600);}.cafe-reserve{color:var(--google-blue-500);}</style><div class="my-card"><iron-list is="dom-repeat" items="{{ listItems }}"><template><paper-card><div class="cafe-header">{{item.Category}}</div><div class="card-actions"><div class="horizontal justified"><paper-button class="cafe-reserve">Update</paper-button><paper-button class="cafe-reserve">Del</paper-button></div></div></paper-card></template></iron-list></div><paper-button raised="" noink="" id="updateCategoryBtn" on-click="updateRecords">Обновить</paper-button></template><script>Polymer({is:"my-view1",onMouseOverItem:function(c){console.log(c)},properties:{listItems:{type:Array,value:[]}},ready:function(){this.listItems=[],this.latestCategoryName="",this.updateRecords()},updateRecords:function(){console.log("---------------------------------------"),this.splice("listItems",0),this.listItems=[];var c=[],d=openCategory.result,f=d.transaction("MyObjectStore1","readwrite"),g=f.objectStore("MyObjectStore1"),h=g.index("categoryName");h.openCursor().onsuccess=function(j){if(cursor=j.target.result,cursor){var k={id:cursor.value.id,categoryName:cursor.value.categoryName,isComplete:cursor.value.isComplete};console.log("cursor: "+cursor.value.id+" "+cursor.value.categoryName+" "+cursor.value.isComplete),c.push(k),cursor.continue()}else console.log("-----test len: "+c.length)},help.sort(function(j,k){return j.id-k.id}),this.updateR(c)},updateR:function(){for(this.splice("listItems",0),i=0;i<help.length;i++){var d={id:help[i].id,categoryName:help[i].categoryName,isComplete:help[i].isComplete};this.push("listItems",d)}},clearList:function(){help.splice(0,help.length)}});var ind=0,cursor,indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.shimIndexedDB,openCategory=indexedDB.open("Data15648",2);openCategory.onupgradeneeded=function(){var c=openCategory.result,d=c.createObjectStore("MyObjectStore1",{keyPath:"id"}),f=d.createIndex("categoryName","categoryName")};var help=[];openCategory.onsuccess=function(){var c=openCategory.result,d=c.transaction("MyObjectStore1","readwrite"),f=d.objectStore("MyObjectStore1"),g=f.index("categoryName");g.openCursor().onsuccess=function(h){if(cursor=h.target.result,cursor){var j={id:cursor.value.id,categoryName:cursor.value.categoryName,isComplete:cursor.value.isComplete};ind<cursor.value.id&&(ind=cursor.value.id),help.push(j),console.log("cursor: "+cursor.value.id+" "+cursor.value.categoryName+" "+cursor.value.isComplete),cursor.continue()}else console.log("ind: "+ind)}};</script></dom-module></body></html>