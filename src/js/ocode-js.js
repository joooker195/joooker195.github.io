function addItem(c){console.log(c)}function add(c){c.open()}function ready(){this.listItems=[],this.latestCategoryName="",this.updateR()}function addRecord(c){this.console(c);var d=openCategory.result,f=d.transaction("MyObjectStore","readwrite"),g=f.objectStore("MyObjectStore");++ind,console.log("ind: "+ind),g.put({id:ind,categoryName:this.latestCategoryName,isComplete:!1}),help.push({id:ind,categoryName:this.latestCategoryName,isComplete:!1}),this.latestCategoryName="",this.updateRecords()}function toggleRecord(c){var d=c.model.item.categoryName,f,g=help.findIndex(function(n){return n.categoryName===d});c.model.item.isComplete?(f=!0,help[g].isComplete=!0):(f=!1,help[g].isComplete=!1);var h=openCategory.result,j=h.transaction("MyObjectStore","readwrite"),k=j.objectStore("MyObjectStore"),l=k.index("categoryName"),m=l.get(d);m.onsuccess=function(){console.log("---------------------------------------"),console.log("toogle: "+d+" complete "+f);var p=m.result;p.isComplete=f;var q=k.put(p);q.onsuccess=function(){console.log("update")}},this.updateRecords()}function editRecord(){var c=this.editCategoryName,d=this.latestCategoryName;console.log("category name: "+c);var f=help.findIndex(function(m){return m.categoryName===d}),g=openCategory.result,h=g.transaction("MyObjectStore","readwrite"),j=h.objectStore("MyObjectStore"),k=j.index("categoryName"),l=k.get(d);l.onsuccess=function(){console.log("---------------------------------------"),console.log("edit: '"+d+"' to '"+c+"'");var n=l.result;n.categoryName=c;var p=j.put(n);p.onsuccess=function(){console.log("edit")}},help[f].categoryName=c,this.$.editRecordDialog.close(),this.updateRecords(),console.log("edit")}function deleteRecord(){var d=this.latestCategoryName,f=openCategory.result,g=f.transaction("MyObjectStore","readwrite"),h=g.objectStore("MyObjectStore"),j=h.index("categoryName"),k=this.listItems.findIndex(function(n){return n.categoryName===d}),l=h.delete(this.listItems[k].id),m=help.findIndex(function(n){return n.categoryName===d});help.splice(m,1),l.onsuccess=function(){console.log("---------------------------------------"),console.log("categoryName: "+d),console.log("key: "+k),console.log("delete")},this.$.deleteRecordDialog.close(),this.updateRecords()}function updateRecords(){console.log("---------------------------------------"),this.splice("listItems",0),this.listItems=[];var c=[],d=openCategory.result,f=d.transaction("MyObjectStore","readwrite"),g=f.objectStore("MyObjectStore"),h=g.index("categoryName");h.openCursor().onsuccess=function(j){if(cursor=j.target.result,cursor){var k={id:cursor.value.id,categoryName:cursor.value.categoryName,isComplete:cursor.value.isComplete};console.log("cursor: "+cursor.value.id+" "+cursor.value.categoryName+" "+cursor.value.isComplete),c.push(k),cursor.continue()}else console.log("-----test len: "+c.length)},help.sort(function(j,k){return j.id-k.id}),this.updateR(c)}function updateR(){for(this.splice("listItems",0),i=0;i<help.length;i++){var d={id:help[i].id,categoryName:help[i].categoryName,isComplete:help[i].isComplete};this.push("listItems",d)}}function clearList(){help.splice(0,help.length)}var ind=0,cursor,indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.shimIndexedDB,openCategory=indexedDB.open("Data7",1);openCategory.onupgradeneeded=function(){var c=openCategory.result,d=c.createObjectStore("MyObjectStore",{keyPath:"id"}),f=d.createIndex("categoryName","categoryName")};var help=[];openCategory.onsuccess=function(){var c=openCategory.result,d=c.transaction("MyObjectStore","readwrite"),f=d.objectStore("MyObjectStore"),g=f.index("categoryName");g.openCursor().onsuccess=function(h){if(cursor=h.target.result,cursor){var j={id:cursor.value.id,categoryName:cursor.value.categoryName,isComplete:cursor.value.isComplete};ind<cursor.value.id&&(ind=cursor.value.id),help.push(j),console.log("cursor: "+cursor.value.id+" "+cursor.value.categoryName+" "+cursor.value.isComplete),cursor.continue()}else console.log("ind: "+ind)}};